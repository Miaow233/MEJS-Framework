# 词库

**在使用词库文件前，请仔细阅读本篇文章，以免造成不必要的损失**

1. 尽量避免使用自己不了解来源的词库文件
2. 在初次使用词库文件时，请关闭敏感权限(发送红包)
3. 不需要红包支付功能时，请不要填写支付密码

## 词库介绍

由于 Medic 不提供任何对话交互服务, 所有的功能都需要我们自行编写, 词库伪代码语法为我们提供了便利.

下面是词库的一些基础使用

## 词库结构

### 词库路径

- 主文件: 手机内存/DIC/hdic.txt
- JS 词库文件: 手机内存/DIC/hdic.js
- 库文件: 手机内存/DIC/libs/

### 词库文件

- 未加密: hdic.txt
- 已加密: hdic.txt，hdic.ef, model.ef

### `hdic.txt` 内容结构

- [词库信息]
- [常量]
- [模块]
- [词条]

## 词库信息

词库信息必须处于`[词库信息]`标签以下，不可空行，不可缺省

| 标签 | 说明                   | 参数               | 参数类型       | 必须 |
| ---- | ---------------------- | ------------------ | -------------- | ---- |
| 权限 | 敏感权限的选择         | 手机信息，红包支付 | 文本           | 否   |
| 名称 | 词库名称               | 自定义             | 文本           | 否   |
| 图标 | 词库图标               | 自定义             | 网址           | 否   |
| 作者 | 词库作者               | 自定义             | 文本           | 否   |
| 版本 | 词库版本               | 自定义             | 文本           | 否   |
| 简介 | 词库简介               | 自定义             | 文本           | 否   |
| 官网 | 词库官网               | 自定义             | 网址           | 否   |
| 关机 | 关机指令，调用同名模块 | 自定义             | 文本           | 是   |
| 开机 | 开机指令，调用同名模块 | 自定义             | 文本           | 是   |
| 加密 | 词库是否已加密         | 自动生成, 不可定义 | `true`/`false` | 否   |

注意事项: 词库标签后可使用 `*` 号进行标记，在加密时指定不可修改的项目

如:

- 作者: 小社\*

加密后未添加 `*` 号的项目为`允许`修改的项目，请注意

例子:

```
[词库信息]
名称:词库DEMO
图标:www.dicq.online/1.jpg
作者:小社*
版本:1.0*
简介:这只是一个例子的简介，内容根据自己的词库说明进行修改*
官网:www.dicq.online*
开机:机器人启动*
关机:机器人关闭*
```

## 词库语法

| 说明            | 语法                      | 样例                              | 注意事项                                                                                             |
| --------------- | ------------------------- | --------------------------------- | :--------------------------------------------------------------------------------------------------- |
| 设置变量        | 变量名(单个字符):变量值   | A:这个是变量 A 的值               | 多字符变量请参考[变量#规定](variable.md#规定)                                                        |
| 获取变量        | @变量名                   | @A                                | 内置特殊变量为多字节变量                                                                             |
| 计算            | calc(公式)                | calc(1+2+3)                       | 支持+(加法)-(减法)\*(乘法)/(除)%(取余数)!(乘阶)l(对数 ln)o(对数 log2)g(开根号)s(sin)c(cos)t(tan)     |
| 判断            | goto(条件)>>跳过的行数    | goto(1<2)>>1                      | 跳过的行数为当前行开始往下，如值为负数则往上，往上时计算 goto 语句本身为一行                         |
| 调用            | 类名->方法名(参数)        | Toolkit->access(url)              | 多个参数使用\,分开                                                                                   |
| JSON 获取       | JSON 字符串(键名)         | {"name":"XXXX"}(name)             | 取出 json 里面 name 的值 XXXX                                                                        |
| 字符串截取      | 字符串[开始位置:结束位置] | Hello Medic[5:]                   | 截取从开始位置到结束位置之间的字符串，负数为倒数位置，起始位置留空为默认开头，结束位置留空为默认结尾 |
| 中断代码        | return`空格`              | return 代码到此结束，之后不再执行 | return 后面有一个空格                                                                                |
| MD5 加密        | md5(参数)                 | md5(123)                          | 对参数进行 MD5 加密                                                                                  |
| URL 编码        | Urlencode(参数)           | Urlencode(你好)                   | 对参数进行 URL 编码                                                                                  |
| URL 解码        | Urldecode(参数)           | Urlencode(%E4%BD%A0%E5%A5%BD)     | 对参数进行 URL 解码                                                                                  |
| B64 编码        | Base64encode(参数)        | Base64encode(你好)                | 对参数进行 B64 编码                                                                                  |
| B64 解码        | Base64decode(参数)        | Base64decode(5L2g5aW9)            | 对参数进行 URL 解码                                                                                  |
| 16 进制转字符串 | Hex2Str(参数)             | Hex2Str(E597A8)                   | 将 16 进制参数转换成字符串                                                                           |

内置变量:

- @robot = 机器人 QQ
- @group = 群号
- @groupName = 群名称
- @uin = 发送者 QQ
- @code = 群 code
- @nick = 发送者昵称
- @mark = 消息标记
- @time = 消息发送时间
- @title = 标题
- @machineCode = 机器码
- @path = 手机根目录

例子:

```java title="hdic.txt"
[词库信息]
名称:词库DEMO
图标:www.dicq.online/1.jpg
作者:小社
版本:1.0
简介:这只是一个例子的简介，内容根据自己的词库说明进行修改
官网:www.dicq.online
开机:开机
关机:关机

[常量]

[模块]
开机
Hello World!

关机
bye~

[词条]
```
